$(document).ready(function(){function e(){swal({title:"Record Deleted!",type:"warning",text:"<center>Refresh Records?</center>",html:!0,showCancelButton:!0,confirmButtonClass:"btn-success",confirmButtonText:"Refresh",cancelButtonText:"Cancel",closeOnConfirm:!0,allowOutsideClick:!0,closeOnCancel:!0},function(e){e&&i.draw()})}$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}}),$(".timepicker").timepicker({showInputs:!1});var t="",a="/coordinator/events",n=new Date;n.setDate(n.getDate()),$("#datepicker").datepicker({defaultDate:"+1w",changeMonth:!0,numberOfMonths:3,autoclose:!0,format:"yyyy-mm-dd",startDate:n});var i=$("#table").DataTable({responsive:!0,processing:!0,serverSide:!0,ajax:dataurl,columnDefs:[{width:"180px",targets:5},{width:"70px",targets:4}],columns:[{data:"title",name:"title"},{data:"date_held",name:"date_held"},{data:"time_from",name:"time_from"},{data:"time_to",name:"time_to"},{data:"status",name:"status",searchable:!1},{data:"action",name:"action",orderable:!1,searchable:!1}]});$("#table-done").DataTable({columnDefs:[{width:"70px",targets:5},{width:"70px",targets:4}]}),$("#btn-add").click(function(){$("#txt").text("Add Event"),$("#btn-save").val("add"),$("#frmEvent").trigger("reset"),$("#add_event").modal("show")}),$("#list").on("click",".open-modal",function(){var n=$(this).val();t=n,$.get(a+"/"+n+"/edit",function(t){"Deleted"==t?e():($("#txt").text("Edit Event"),$("#frmEvent").trigger("reset"),$("#title").val(t.title),$("#place_held").val(t.place_held),$("#time_from").val(t.time_from),$("#time_to").val(t.time_to),$("#datepicker").val(t.date_held),$("#description").val(t.description),$("#btn-save").val("update"),$("#add_event").modal("show"))})}),$("#btn-save").click(function(){if($("#frmEvent").parsley().destroy(),$("#frmEvent").parsley().isValid()){$("#btn-save").attr("disabled","disabled"),setTimeout(function(){$("#btn-save").removeAttr("disabled")},1e3);var e={title:$("#title").val(),place_held:$("#place_held").val(),time_from:$("#time_from").val(),time_to:$("#time_to").val(),date_held:$("#datepicker").val(),description:$("#description").val()},n=$("#btn-save").val(),o="POST",r=a;"update"==n&&(o="PUT",r+="/"+t),$.ajax({type:o,url:r,data:e,dataType:"json",success:function(e){$("#add_event").modal("hide"),i.draw(),swal({title:"Success!",text:"<center>Data Stored</center>",type:"success",timer:1e3,showConfirmButton:!1,html:!0})},error:function(e){$.notify({icon:"fa fa-warning",message:e.responseText.replace(/['"]+/g,"")},{type:"warning",z_index:2e3,delay:5e3})}})}}),$("#list").on("click",".btn-delete",function(){var t=$(this).val();swal({title:"Are you sure?",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"Delete",cancelButtonText:"Cancel",closeOnConfirm:!1,allowOutsideClick:!0,showLoaderOnConfirm:!0,closeOnCancel:!0},function(n){setTimeout(function(){n&&$.ajax({url:a+"/"+t,type:"DELETE",success:function(t){"Deleted"==t?e():"true"==t[0]?swal({title:"Failed!",text:"<center>Data in use</center>",type:"error",showConfirmButton:!1,allowOutsideClick:!0,html:!0}):(i.draw(),swal({title:"Deleted!",text:"<center>Data Deleted</center>",type:"success",timer:1e3,showConfirmButton:!1,html:!0}))},error:function(e){}})},500)})}),$("#list").on("change","#isActive",function(){var t=$(this).val(),a="Cancelled";if($(this).prop("checked"))a="Ongoing";var n={status:a};$.ajax({url:"/coordinator/events/checkbox/"+t,type:"PUT",data:n,success:function(t){Pace.restart(),"Deleted"==t&&e()},error:function(e){}})})});